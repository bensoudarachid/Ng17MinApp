<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10 col-lg-8">
      <!-- Removed ngb-alert, relying on field-level validation -->
      <section class="card">
        <div class="card-body">
          <!-- Added 'needs-validation' and removed novalidate if we want browser validation disabled -->
          <form id="trainingdetailsform" [formGroup]="trainingForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
            <h2 class="card-title text-center mb-4">Edit Training</h2>

            <div class="row g-3"> <!-- Added g-3 for gutters -->
              <div class="col-12 col-md-6">
                <!-- Replaced form-group with mb-3 -->
                <div class="mb-3">
                  <label for="title" class="form-label">Title</label>
                  <input
                    id="title"
                    type="text"
                    formControlName="title"
                    class="form-control"
                    [class.is-invalid]="!isTitleValid()"
                    [readonly]="appSignalStore.ui.isSaving()"
                    required
                  />
                  <!-- Replaced custom span with invalid-feedback -->
                  <div *ngIf="!isTitleValid()" class="invalid-feedback">{{titleError}}</div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="mb-3">
                  <label for="secondaryTitle" class="form-label">Secondary Title</label>
                  <input
                    id="secondaryTitle"
                    type="text"
                    formControlName="secondaryTitle"
                    class="form-control"
                    [class.is-invalid]="validateSecondaryTitle()"
                    [readonly]="appSignalStore.ui.isSaving()"
                    required
                  />
                  <div *ngIf="validateSecondaryTitle()" class="invalid-feedback">This field is required.</div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="mb-3">
                  <label for="shortDescription" class="form-label">Short Description</label>
                  <input
                    id="shortDescription"
                    type="text"
                    formControlName="shortDescription"
                    class="form-control"
                    [class.is-invalid]="validateShortDescription()"
                    [readonly]="appSignalStore.ui.isSaving()"
                    required
                  />
                  <div *ngIf="validateShortDescription()" class="invalid-feedback">This field is required.</div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="mb-3">
                  <label for="longDescription" class="form-label">Long Description</label>
                  <input
                    id="longDescription"
                    type="text"
                    formControlName="longDescription"
                    class="form-control"
                    [class.is-invalid]="validateLongDescription()"
                    [readonly]="appSignalStore.ui.isSaving()"
                  />
                  <!-- Assuming long description is optional based on TS validators, only showing required error if it exists -->
                   <div *ngIf="validateLongDescription()" class="invalid-feedback">This field is required.</div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="mb-3">
                  <label for="role" class="form-label">Role</label>
                  <select id="role" formControlName="roleId" class="form-select" [class.is-invalid]="trainingForm.get('roleId')?.invalid && (trainingForm.get('roleId')?.dirty || trainingForm.get('roleId')?.touched || isSubmitted)" [disabled]="appSignalStore.ui.isSaving()">
                    <option *ngFor="let role of roles" [ngValue]="role.id">{{role.title}}</option>
                  </select>
                   <div *ngIf="trainingForm.get('roleId')?.invalid && (trainingForm.get('roleId')?.dirty || trainingForm.get('roleId')?.touched || isSubmitted)" class="invalid-feedback">Please select a role.</div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="mb-3">
                  <label for="image" class="form-label">Training Image</label>
                  <input
                    id="image"
                    type="file"
                    class="form-control"
                    (change)="onFileSelected($event)"
                    accept="image/*"
                    [disabled]="appSignalStore.ui.isSaving()"
                  />
                  <!-- Add validation feedback for file if needed -->
                </div>
              </div>
            </div>

            <!-- Buttons with improved spacing -->
            <div class="d-grid gap-3 d-md-flex justify-content-md-center mt-5">
              <button type="submit" class="btn btn-primary app-btn" [disabled]="trainingForm.invalid || appSignalStore.ui.isSaving()">Save Changes</button>
              <button type="button" class="btn btn-outline-secondary app-btn" (click)="trainingForm.reset()" [disabled]="appSignalStore.ui.isSaving()">Reset Form</button>
            </div>
          </form>
        </div>
      </section>
    </div>
  </div>
</div>
